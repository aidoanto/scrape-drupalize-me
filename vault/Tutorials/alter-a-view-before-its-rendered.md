---
title: "Alter a View before It's Rendered"
url: "https://drupalize.me/tutorial/alter-view-its-rendered?p=2939"
guide: "[[views-drupal]]"
---

# Alter a View before It's Rendered

## Content

Developers can implement `hook_views_pre_render()` to make changes to a `ViewsExecutable` object and change the render array that gets generated by the render phase of a view. By the time `hook_views_pre_render()` gets invoked, the data to display has already been collected, and things like field formatter configuration have been loaded. This hook gives you the opportunity to dynamically alter that configuration before it's passed to field handlers that will ultimately calculate and return a render array by combining the field configuration with the query results.

You might, for example, dynamically change the label used in a table depending on context that doesn't exist in the view itself. Another example, and the one we'll use here, is transforming a view's rows into a slider (or tabs, or an accordion). That requires that you alter the views object before rendering and attach a custom JavaScript library.

If the thing you want to change is the configuration of the display or any fields, or the contents of the results (versus the *presentation* of the results) of a view, than `hook_views_pre_render()` is the right place to do that. If you're looking to alter the generated render array than you'll likely want to use `hook_views_post_render()`.

In this tutorial we'll:

- Alter a `ViewsExecutable` object using `hook_views_pre_render()` before the view is rendered.
- Attach custom JavaScript (or CSS) to a view.
- Transform a view of article nodes into an interactive slider using the Slick Slider JavaScript library and some custom JavaScript code.

By the end of this tutorial, you should know how to alter the render array of a view and attach custom and third-party asset libraries in a Drupal site.

## Goal

Implement `hook_views_pre_render()` to attach a JavaScript library to a view during its pre-render cycle, and transform a view of article nodes into a slider.

## Prerequisites

- [What Are Render Arrays?](https://drupalize.me/tutorial/what-are-render-arrays)
- [Attach a Library](https://drupalize.me/tutorial/attach-asset-library)
- [Overview: Build and Render Cycles in Views](https://drupalize.me/tutorial/overview-build-and-render-cycles-views)
- [Views in Drupal](https://drupalize.me/guide/views-drupal)
- [Implement a Hook](https://drupalize.me/tutorial/implement-any-hook)

## Follow these steps

### Create and enable a custom module

For this tutorial, we'll create a custom module named `slider`.

Create a custom module named `slider`, including a *slider.info.yml* file and a *slider.module* file. Install the module.

### Download Slick Slider library

For this tutorial, we'll be using the [Slick Slider library](https://kenwheeler.github.io/slick). Slick Slider is a flexible open source library that provides slider functionality with configurable options. It can also be used in your project through its CDN version. For our tutorial we'll download the script from the library website.

Download the library to your computer.

### Place the library files

After downloading the library to your computer, expand the code archive (*.zip* file), and place the inner *slick/* folder inside the *libraries/* directory in the root of your Drupal project. If you don't have a *libraries/* directory in the root of your Drupal project, create one.
This will result in a directory structure like the following:

```
.
├── autoload.php
├── core
├── index.php
├── libraries
│   └── slick/
├── modules
├── profiles
├── robots.txt
├── sites
├── themes
├── update.php
└── web.config
```

### Tell Drupal about the library

In order for Drupal to know about the library, we need to define it in the *slider.libraries.yml* file of our module.

Create *modules/custom/slider/slider.libraries.yml* and add the following code into it:

```
slider:
  version: 1.x
  js:
    /libraries/slick/slick.min.js: {}
    js/init_slick.js: {}
  css:
    theme:
      /libraries/slick/slick.css: {}
  dependencies:
    - core/jquery
    - core/drupal
```

Notice that we're including 3 files in our new `slider` library definition:

- *slick.min.js*, and *slick.css*: The JavaScript code for the Slick Slider library, which is located in the */libraries* directory of our project.
- *init\_slick.js*: This file will live in our module and will hold the initialization code for the slider. We'll create this file in a subsequent step.

### Build a view

Using the Views UI (*admin/structure/views*), build a View named "News" that displays a list of *Article* nodes using a block display of *teasers* in an *Unformatted list* limited to 5 items. [Place the resulting block on a page](https://drupalize.me/tutorial/user-guide/block-place?p=3068) so that it's visible.

The result should look something like this:

Image

![Screenshot of news view block displaying teasers to 2 article nodes.](/sites/default/files/styles/max_800w/public/tutorials/images/news_view.png?itok=Ksrtcjpt)

And configuration may look something like the following:

Image

![Screenshot of news view block configuration as described above.](/sites/default/files/styles/max_800w/public/tutorials/images/news_view_config.png?itok=7X7Iy6BX)

If you'd like to learn more about how to create a content listing with Views UI, refer to [9.3. Creating a Content List View](https://drupalize.me/tutorial/user-guide/views-create?p=2449) in the Drupal User Guide or our [Views in Drupal](https://drupalize.me/https%3A//drupalize.me/guide/views-drupal) guide.

### Write hook\_views\_pre\_render()

In the *slider.module* file, implement `hook_views_pre_render()`.

Example *modules/slider/slider.module*:

```
/**
 * Implements hook_views_pre_render().
 */
function slider_views_pre_render(\Drupal\views\ViewExecutable $view) {
  if ($view->id() == 'news') {
    $view->element['#attached']['library'][] = 'slider/slider';
  }
}
```

In this function, we are checking for the view id (in our case it's `news`), and then attaching the asset library we defined in *slider.libraries.yml* via the `#attached` key of the `$view->element` array. The view's id is the machine name of your view and can be found on the Views administration page at *Structure* > *Views* (*/admin/structure/views*).

This render array may also be used to alter the `#cache` property of the view. For example, to prevent this display from caching the rendered output by setting the `max-age` property to `0`. [Custom cache tags](https://drupalize.me/tutorial/add-cache-metadata-render-arrays) can also be added here.

In addition to the `$view->element` render array, this hook provides access to the render arrays of all fields used in the display. These arrays can also be altered before rendering.

### Write slider initialization code

Next, we need to write the slider initiation code.

Create the file *modules/custom/slider/js/init\_slick.js* with the following code:

```
/**
 * @file
 * Helper JavaScript for initializing sliders.
 */
(function ($, Drupal) {
  $(document).ready(function() {
    const slider = $('.view-news .view-content');
    slider.slick({
      slidesToShow: 1,
      slidesToScroll: 1,
      dots: false,
      arrows: true,
      infinite: true,
      speed: 700,
      autoplaySpeed: 5000,
      autoplay: true
    });
  });

})(jQuery, Drupal);
```

This code uses jQuery's `ready()` method to wait for the DOM, and then initializes an instance of the slider library attached to the `<div class="view-content">` element inside the *news* view.

To test it you'll need to [clear the cache](https://drupalize.me/tutorial/clear-drupals-cache) and reload the page. Your *news* view block should now be transformed into a slider.

Example:

Image

![Screenshot of the slider](/sites/default/files/styles/max_800w/public/tutorials/images/slider.png?itok=x2HQKF99)

**Tip**: Play around with different options for the Teaser display of Article content (*admin/structure/types/manage/article/display/teaser*), such as displaying "Trimmed only" content and limiting the number characters.

Refer to the official Slick Slider documentation to [read about the available options](https://kenwheeler.github.io/slick).

## Recap

In this tutorial, we learned how to use `hook_views_pre_render()` to alter the renderable array that represents the view being displayed. We did this to attach a custom JavaScript library that transforms a specific views block into a slider. This technique is not limited to our slider example, and can be used for any JavaScript functionality as well as for other alterations to the Views object prior to rendering.

## Further your understanding

- Can you describe the where in the build cycle this View is when `hook_views_pre_render()` is invoked?
- What other use-cases can you think of for `hook_views_pre_render()`?
- Can you describe what you would need to do to make the configuration options of the slider available to an admin rather than hard-coded?

## Additional resources

- [List of views hooks](https://api.drupal.org/api/drupal/core%21modules%21views%21views.api.php/11.x) (api.drupal.org)
- [Change record: Support for third party libraries in site specific and install profile specific libraries folders](https://www.drupal.org/node/3099614) (Drupal.org)

Was this helpful?

Yes

No

Any additional feedback?

Previous
[Overview: Build and Render Cycles in Views](/tutorial/overview-build-and-render-cycles-views?p=2939)

Next
[Alter a View after the Render Process](/tutorial/alter-view-after-render-process?p=2939)

Clear History

Ask Drupalize.Me AI

close